{"ast":null,"code":"const S3 = require('aws-sdk/clients/s3');\n\nconst formidable = require('formidable');\n\nconst multer = require('multer');\n\nconst upload = multer().single('soundBlob');\nconst s3 = new S3({\n  apiVersion: '2006-03-01'\n});\nexport const config = {\n  api: {\n    bodyParser: false\n  }\n};\nexport default async function handler(req, res) {\n  if (req.method === 'POST') {\n    // const form = new formidable({ multiples: true });\n    // console.log('hello before form.parse');\n    // console.log('req.body', JSON.stringify(req.body));\n    console.log('req', req); // await new Promise((reject, resolve) => {\n    //   form.parse(req, (err, fields, files) => {\n    //     console.log('hello from inside');\n    //     // console.log('files', files);\n    //   });\n    //   resolve();\n    // });\n\n    res.end();\n    return; // upload(req, res, (err, variable) => {\n    //   if (err instanceof multer.MulterError) {\n    //     console.log('instanceof multer', err);\n    //   } else if (err) {\n    //     console.log('err', err);\n    //   }\n    // await s3.upload(\n    //   {\n    //     Bucket: process.env.AWS_BUCKET,\n    //     Key: req.file.originalname,\n    //     Body: Buffer.from(new Uint8Array(req.file.buffer)),\n    //   },\n    //   async (err, data) => {\n    //     if (err) {\n    //       console.log('error: ', err);\n    //       res.sendStatus(404);\n    //     }\n    //     res.send(\n    //       `https://${process.env.AWS_BUCKET}/${escape(req.file.originalname)}`\n    //     );\n    //   }\n    // );\n    //   console.log('req', req.body);\n    //   console.log('variable', variable);\n    // })\n  }\n}","map":{"version":3,"sources":["/Users/mfjvacas/Documents/Dev/GitHub/projects/mapstereo-client/pages/api/upload.ts"],"names":["S3","require","formidable","multer","upload","single","s3","apiVersion","config","api","bodyParser","handler","req","res","method","console","log","end"],"mappings":"AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAC,oBAAD,CAAlB;;AACA,MAAMC,UAAU,GAAGD,OAAO,CAAC,YAAD,CAA1B;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAD,CAAtB;;AACA,MAAMG,MAAM,GAAGD,MAAM,GAAGE,MAAT,CAAgB,WAAhB,CAAf;AAEA,MAAMC,EAAE,GAAG,IAAIN,EAAJ,CAAO;AAAEO,EAAAA,UAAU,EAAE;AAAd,CAAP,CAAX;AAEA,OAAO,MAAMC,MAAM,GAAG;AACpBC,EAAAA,GAAG,EAAE;AACHC,IAAAA,UAAU,EAAE;AADT;AADe,CAAf;AAMP,eAAe,eAAeC,OAAf,CAAuBC,GAAvB,EAA4BC,GAA5B,EAAiC;AAC9C,MAAID,GAAG,CAACE,MAAJ,KAAe,MAAnB,EAA2B;AACzB;AAEA;AAEA;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBJ,GAAnB,EANyB,CAQzB;AACA;AACA;AAEA;AACA;AAEA;AACA;;AAEAC,IAAAA,GAAG,CAACI,GAAJ;AACA,WAnByB,CAoBzB;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACD;AACF","sourcesContent":["const S3 = require('aws-sdk/clients/s3');\nconst formidable = require('formidable');\nconst multer = require('multer');\nconst upload = multer().single('soundBlob');\n\nconst s3 = new S3({ apiVersion: '2006-03-01' });\n\nexport const config = {\n  api: {\n    bodyParser: false,\n  }\n}\n\nexport default async function handler(req, res) {\n  if (req.method === 'POST') {\n    // const form = new formidable({ multiples: true });\n\n    // console.log('hello before form.parse');\n\n    // console.log('req.body', JSON.stringify(req.body));\n    console.log('req', req);\n\n    // await new Promise((reject, resolve) => {\n    //   form.parse(req, (err, fields, files) => {\n    //     console.log('hello from inside');\n\n    //     // console.log('files', files);\n    //   });\n\n    //   resolve();\n    // });\n\n    res.end();\n    return;\n    // upload(req, res, (err, variable) => {\n    //   if (err instanceof multer.MulterError) {\n    //     console.log('instanceof multer', err);\n\n    //   } else if (err) {\n    //     console.log('err', err);\n\n    //   }\n\n    // await s3.upload(\n    //   {\n    //     Bucket: process.env.AWS_BUCKET,\n    //     Key: req.file.originalname,\n    //     Body: Buffer.from(new Uint8Array(req.file.buffer)),\n    //   },\n    //   async (err, data) => {\n    //     if (err) {\n    //       console.log('error: ', err);\n    //       res.sendStatus(404);\n    //     }\n\n    //     res.send(\n    //       `https://${process.env.AWS_BUCKET}/${escape(req.file.originalname)}`\n    //     );\n    //   }\n    // );\n\n    //   console.log('req', req.body);\n\n    //   console.log('variable', variable);\n\n    // })\n  }\n}\n"]},"metadata":{},"sourceType":"module"}