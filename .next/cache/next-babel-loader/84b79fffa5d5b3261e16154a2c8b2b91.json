{"ast":null,"code":"const S3 = require('aws-sdk/clients/s3');\n\nconst formidable = require('formidable'); // const multer = require('multer');\n// const upload = multer().single('soundBlob');\n\n\nconst s3 = new S3({\n  apiVersion: '2006-03-01'\n});\nexport default function handler(req, res) {\n  if (req.method === 'POST') {\n    const form = new formidable.IncomingForm();\n    console.log('hello before form.parse');\n    form.parse(req, (err, fields, files) => {\n      console.log('hello from inside');\n      console.log('files', files);\n    });\n    res.end();\n    return; // upload(req, res, (err, variable) => {\n    //   if (err instanceof multer.MulterError) {\n    //     console.log('instanceof multer', err);\n    //   } else if (err) {\n    //     console.log('err', err);\n    //   }\n    // await s3.upload(\n    //   {\n    //     Bucket: process.env.AWS_BUCKET,\n    //     Key: req.file.originalname,\n    //     Body: Buffer.from(new Uint8Array(req.file.buffer)),\n    //   },\n    //   async (err, data) => {\n    //     if (err) {\n    //       console.log('error: ', err);\n    //       res.sendStatus(404);\n    //     }\n    //     res.send(\n    //       `https://${process.env.AWS_BUCKET}/${escape(req.file.originalname)}`\n    //     );\n    //   }\n    // );\n    //   console.log('req', req.body);\n    //   console.log('variable', variable);\n    // })\n  }\n}","map":{"version":3,"sources":["/Users/mfjvacas/Documents/Dev/GitHub/projects/mapstereo-client/pages/api/upload.ts"],"names":["S3","require","formidable","s3","apiVersion","handler","req","res","method","form","IncomingForm","console","log","parse","err","fields","files","end"],"mappings":"AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAC,oBAAD,CAAlB;;AACA,MAAMC,UAAU,GAAGD,OAAO,CAAC,YAAD,CAA1B,C,CACA;AACA;;;AAEA,MAAME,EAAE,GAAG,IAAIH,EAAJ,CAAO;AAAEI,EAAAA,UAAU,EAAE;AAAd,CAAP,CAAX;AAGA,eAAe,SAASC,OAAT,CAAiBC,GAAjB,EAAsBC,GAAtB,EAA2B;AACxC,MAAID,GAAG,CAACE,MAAJ,KAAe,MAAnB,EAA2B;AACzB,UAAMC,IAAI,GAAG,IAAIP,UAAU,CAACQ,YAAf,EAAb;AAEAC,IAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AAGAH,IAAAA,IAAI,CAACI,KAAL,CAAWP,GAAX,EAAgB,CAACQ,GAAD,EAAMC,MAAN,EAAcC,KAAd,KAAwB;AACtCL,MAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AAEAD,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBI,KAArB;AAED,KALD;AAOAT,IAAAA,GAAG,CAACU,GAAJ;AACA,WAdyB,CAezB;AACA;AACA;AAEA;AACA;AAEA;AAEE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEF;AAEA;AAEA;AACD;AACF","sourcesContent":["const S3 = require('aws-sdk/clients/s3');\nconst formidable = require('formidable');\n// const multer = require('multer');\n// const upload = multer().single('soundBlob');\n\nconst s3 = new S3({ apiVersion: '2006-03-01' });\n\n\nexport default function handler(req, res) {\n  if (req.method === 'POST') {\n    const form = new formidable.IncomingForm();\n\n    console.log('hello before form.parse');\n    \n\n    form.parse(req, (err, fields, files) => {\n      console.log('hello from inside');\n      \n      console.log('files', files);\n      \n    });\n    \n    res.end();\n    return;\n    // upload(req, res, (err, variable) => {\n    //   if (err instanceof multer.MulterError) {\n    //     console.log('instanceof multer', err);\n        \n    //   } else if (err) {\n    //     console.log('err', err);\n        \n    //   }\n\n      // await s3.upload(\n      //   {\n      //     Bucket: process.env.AWS_BUCKET,\n      //     Key: req.file.originalname,\n      //     Body: Buffer.from(new Uint8Array(req.file.buffer)),\n      //   },\n      //   async (err, data) => {\n      //     if (err) {\n      //       console.log('error: ', err);\n      //       res.sendStatus(404);\n      //     }\n    \n      //     res.send(\n      //       `https://${process.env.AWS_BUCKET}/${escape(req.file.originalname)}`\n      //     );\n      //   }\n      // );\n\n    //   console.log('req', req.body);\n\n    //   console.log('variable', variable);\n      \n    // })\n  }\n}"]},"metadata":{},"sourceType":"module"}